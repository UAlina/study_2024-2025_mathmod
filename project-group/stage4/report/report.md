---
## Front matter
title: "Этап 4. Защита проекта. Коллективное обсуждение результата проекта, самооценка деятельности"
author:
  - "Стариков Данила Андреевич"
  - "Коннова Татьяна Алексеевна"
  - "Нефедова Наталия Николаевна"
  - "Тарутина Кристина Еленовна"
  - "Уткина Алина Дмитриевна"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: false # List of figures
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
	- spelling=modern
	- babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: PT Sans
romanfont: PT Sans
sansfont: PT Sans
monofont: PT Sans
mainfontoptions: Ligatures=TeX
romanfontoptions: Ligatures=TeX
sansfontoptions: Ligatures=TeX,Scale=MatchLowercase
monofontoptions: Scale=MatchLowercase,Scale=0.9
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float} # keep figures where there are in the text
  - \floatplacement{figure}{H} # keep figures where there are in the text
---

# Цель работы

На данном этапе целью работы является коллективное обсуждение результата проекта и самооценка деятельности
Основной же целью проекта являлось моделирование образования планетной системы из межзвездного газа, представленного как скопление частиц, которые испытывают гравитационное притяжение к центральному телу (“Солнцу”) и движутся по круговым орбитам с первой космической скоростью.

# Теоретическая основа проектаЫ

## Современные теории формирования планетных систем

Согласно современным космологическим моделям, образование планетных систем является результатом сложных взаимодействий в протопланетном диске, окружающем молодую звезду. Теория формирования планетных систем базируется на нескольких ключевых процессах:

1. **Образование протозвезды и протопланетного диска**: После коллапса межзвездного газопылевого облака формируется центральная протозвезда, окруженная вращающимся диском.

2. **Аккреция и рост пылевых частиц**: Микроскопические частицы пыли сталкиваются и слипаются, образуя более крупные агрегаты - планетезимали.

3. **Формирование протопланет**: Планетезимали продолжают расти путем гравитационного притяжения и столкновений, образуя протопланеты.

4. **Миграция планет**: Взаимодействие с газом в диске и гравитационные взаимодействия могут приводить к миграции протопланет внутрь или наружу диска.

5. **Образование стабильной планетной системы**: После рассеивания газа системы планет могут стабилизироваться, образуя системы, подобные Солнечной.

В нашем проекте мы сфокусировались на упрощенной модели, где частицы движутся вокруг центрального тела (подобно "Солнцу") под действием гравитационных сил. Хотя наша модель не учитывает все сложности реальных процессов формирования планетных систем, она позволяет визуализировать основные механизмы гравитационного взаимодействия и движения по орбитам.

## Математическая модель

Для моделирования образования планетной системы мы использовали два подхода:

### Аналитический подход

В рамках аналитического подхода рассматривается движение частиц по круговым орбитам вокруг центрального тела с массой M под действием гравитационной силы:

- Для частицы на орбите радиуса $r_i$ первая космическая скорость:
  $$v_i = √(GM/r_i)$$

- Угловая скорость частицы:
  $$ω_i = v_i/r_i = √(GM/r_i³)$$

- Положение частицы в момент времени $t$:
  $$x_i(t) = r_i·cos(ω_i·t + θ_i,0)$$
  $$y_i(t) = r_i·sin(ω_i·t + θ_i,0)$$

где $θ_i$, 0 — начальный угол частицы на орбите.

### Численный подход

В численном подходе мы решаем систему дифференциальных уравнений второго порядка, описывающих движение частиц под действием гравитационного притяжения:

- Уравнения движения:
  $$m_i·d²r_i/dt² = F_i$$

которые можно переписать как систему уравнений первого порядка:
  $$dr_i/dt = v_i$$
  $$dv_i/dt = a_i$$

где $a_i = F_i/m_i$ — ускорение частицы.

- Начальные условия:
  $$r_i(t=0) = r_i0$$
  $$v_i(t=0) = v_i0$$

## Алгоритмы решения задачи

Для численного решения уравнений движения мы использовали алгоритм Верле, который обеспечивает хорошую точность и стабильность при моделировании гравитационных систем.

### Алгоритм Верле

Алгоритм Верле для расчета траекторий имеет следующий вид:

$$r^(n+1)_i = r^n_i + v^n_i·Δt + a^n_i·Δt²/2$$
$$v^(n+1)_i = v^n_i + (a^n_i + a^(n+1)_i)·Δt/2$$

Для оптимизации вычислений можно использовать модифицированную схему:

$$v^(n+1/2)_i = v^n_i + a^n_i·Δt/2$$
$$r^(n+1)_i = r^n_i + v^(n+1/2)_i·Δt$$
$$v^(n+1)_i = v^(n+1/2)_i + a^(n+1)_i·Δt/2$$

## Расчет сил и ускорений

Ускорение частицы определяется действующими на неё силами:

1. Гравитационное притяжение к центральному телу:
   $$F = γ·m_i·M/r²$$

2. Сила отталкивания между частицами (добавлена для предотвращения слияния):
   $$F_r(b) = k·((a/b)^8 - 1)$$

где $a = R_i + R_j$ — сумма радиусов частиц, $b = |r_i - r_j|$ — расстояние между частицами.

# Программная реализация

Модель была реализована на языке программирования Julia с использованием следующих пакетов:
- Plots — для визуализации результатов
- DifferentialEquations — для численного решения дифференциальных уравнений

## Структура программы

1. Инициализация системы частиц с заданными начальными положениями и скоростями
2. Расчет траекторий с использованием алгоритма Верле
3. Визуализация результатов в виде анимации движения частиц

Ключевой фрагмент кода для моделирования движения частиц:

```julia
function simulate_particles(N::Int, time_steps::Int, dt::Float64, central_mass::Float64)
	positions = zeros(Float64, N, 2)
	velocities = zeros(Float64, N, 2)
    
	for i in 1:N
    	r = 10.0 * i
    	v = sqrt(central_mass / r)

    	positions[i, :] = [r, 0.0]
    	velocities[i, :] = [0.0, v]
	end
    

	trajectory = zeros(Float64, time_steps, N, 2)
    
	for t in 1:time_steps
    	for i in 1:N
        	r = norm(positions[i, :])
        	acceleration = -central_mass * positions[i, :] / r^3
        	velocities[i, :] += acceleration * dt
        	positions[i, :] += velocities[i, :] * dt
        	trajectory[t, i, :] = positions[i, :]
    	end
	end
    

	return trajectory
end
```

## Визуализация результатов

Для визуализации результатов моделирования был создан код, который генерирует анимацию движения частиц вокруг центрального тела:

```julia
function plot_trajectory(trajectory)
    time_steps, N, _ = size(trajectory)

    anim = []

    for t in 1:time_steps
        x = trajectory[t, :, 1]
        y = trajectory[t, :, 2]

        scatter(x, y, xlims=(-500, 500), ylims=(-500, 500), aspect_ratio=:equal, legend=false,
                title="Particle Orbits")
    end
    
    gif(anim, "particle_orbits.gif", fps=30)
end

N = 10
time_steps = 500
dt = 0.01
central_mass = 1000.0


trajectory = simulate_particles(N, time_steps, dt, central_mass)
plot_trajectory(trajectory)
```

# Анализ результатов моделирования

## Полученные траектории

В результате моделирования были получены траектории движения частиц вокруг центрального тела. Визуализация показала, что частицы действительно движутся по круговым орбитам с радиусами, соответствующими их начальным положениям. Это согласуется с теоретическими предсказаниями для движения под действием центральной гравитационной силы.

## Стабильность системы

Наблюдения за эволюцией системы в течение продолжительного времени показали, что орбиты частиц остаются стабильными при отсутствии взаимодействия между ними. Это ожидаемый результат, так как для изолированной системы "частица-центральное тело" круговая орбита является устойчивым решением при условии правильного выбора начальной скорости (первой космической).

## Сравнение аналитического и численного подходов

Сравнение результатов, полученных с помощью аналитического решения и численного моделирования, показало хорошее согласие между ними. Это подтверждает корректность реализации алгоритма Верле для решения уравнений движения.

Небольшие расхождения, которые наблюдаются при длительном моделировании, можно объяснить накоплением численных ошибок при интегрировании уравнений движения. Это известное свойство численных методов, которое можно минимизировать путем уменьшения шага по времени или использования методов более высокого порядка точности.

# Итоги

## Основные результаты

1. Разработана математическая модель для описания движения частиц под действием центральной гравитационной силы.
2. Реализованы два подхода к моделированию: аналитический (с использованием точного решения для круговых орбит) и численный (с использованием алгоритма Верле).
3. Создана программная реализация модели на языке Julia, позволяющая визуализировать движение частиц в виде анимации.
4. Продемонстрирована стабильность орбит частиц при отсутствии взаимодействия между ними.

## Ограничения модели

Следует отметить, что разработанная модель имеет ряд ограничений:

1. Моделирование проводится в двумерном пространстве, тогда как реальные планетные системы трехмерны.
2. Не учитывается взаимодействие между частицами, которое играет важную роль в реальных процессах формирования планет.
3. Не рассматриваются эффекты сопротивления среды, которые могут существенно влиять на движение малых частиц в протопланетном диске.
4. Не учитывается эволюция центрального тела (звезды) и его влияние на окружающую среду через излучение и звездный ветер.

# Выводы

## Соответствие теоретическим представлениям

Несмотря на указанные ограничения, полученные результаты хорошо согласуются с базовыми теоретическими представлениями о движении тел под действием гравитации. Модель корректно воспроизводит закономерности кеплеровского движения и демонстрирует стабильность круговых орбит.

В то же время для более полного описания процесса формирования планетной системы необходимо учитывать дополнительные физические процессы, такие как аккреция вещества, взаимодействие между формирующимися планетезималями, влияние газовой составляющей диска и т.д.



